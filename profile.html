<!DOCTYPE html>
<html lang="de">
<head>
    <title>Profilseite</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h2>Ihr Profil</h2>
    <form id="profile-form">
        <label for="Name">Name:</label>
        <input type="text" id="name" required><br>
        
        <label for="Vorname">Vorname:</label>
        <input type="text" id="vorname" required><br>
        
        <label for="Straße">Straße:</label>
        <input type="text" id="straße" required><br>
        
        <label for="Stadt">Stadt:</label>
        <input type="text" id="stadt" required><br>
        
        <label for="PLZ">PLZ:</label>
        <input type="text" id="plz" required><br>
        
        <button type="submit">Speichern</button>
        <p id="profile-error" class="error-message"></p>
    </form>

    <script type="module">
        import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

        const supabaseUrl = 'https://vaugbzzhenbkmcuuoeai.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhdWdienpoZW5ia21jdXVvZWFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjg5MTgwODcsImV4cCI6MjA0NDQ5NDA4N30.BAKeLpt5GTm4eu9yQYCoNHL3pDVjk3q5aibIP5bkVIE';
        const supabase = createClient(supabaseUrl, supabaseKey);

        document.getElementById('profile-form').addEventListener('submit', async function(event) {
            event.preventDefault();
            
            const name = document.getElementById('name').value;
            const vorname = document.getElementById('vorname').value;
            const straße = document.getElementById('straße').value;
            const stadt = document.getElementById('stadt').value;
            const plz = document.getElementById('plz').value;
            
            try {
                const { data, error } = await supabase
                    .from('profile')
                    .insert([{ Name: name, Vorname: vorname, Straße: straße, Stadt: stadt, PLZ: plz }]); // Ensure casing matches database columns

                console.log(data, error);

                if (error) {
                    document.getElementById('profile-error').textContent = `Fehler: ${error.message}`;
                } else {
                    alert('Profil gespeichert!');
                }
            } catch (err) {
                document.getElementById('profile-error').textContent = `Fehler: ${err.message}`;
            }
        });
    </script>
</body>
</html>
