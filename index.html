<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webshop - Grußkarten</title>
</head>
<body>

<!-- Navigation -->
<nav>
    <a href="#trauerkarten" onclick="showCategory('trauerkarten')">Trauerkarten</a>
    <a href="#hochzeitskarten" onclick="showCategory('hochzeitskarten')">Hochzeitskarten</a>
    <a href="#glueckwunschkarten" onclick="showCategory('glueckwunschkarten')">Glückwunschkarten</a>
    <a href="#weihnachtskarten" onclick="showCategory('weihnachtskarten')">Weihnachtskarten</a>
    <a href="#eventkarten" onclick="showCategory('eventkarten')">Eventkarten</a>
</nav>

<!-- Hauptinhalt -->
<div id="main-content">
    <!-- Produktlisten für die verschiedenen Kategorien -->
    <section id="trauerkarten" class="product-list category" style="display: none;"></section>
    <section id="hochzeitskarten" class="product-list category" style="display: none;"></section>
    <section id="glueckwunschkarten" class="product-list category" style="display: none;"></section>
    <section id="weihnachtskarten" class="product-list category" style="display: none;"></section>
    <section id="eventkarten" class="product-list category" style="display: none;"></section>
</div>

<!-- Supabase SDK -->
<script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';

    const supabaseUrl = 'https://vaugbzzhenbkmcuuoeai.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZhdWdienpoZW5ia21jdXVvZWFpIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjg5MTgwODcsImV4cCI6MjA0NDQ5NDA4N30.BAKeLpt5GTm4eu9yQYCoNHL3pDVjk3q5aibIP5bkVIE';
    const supabase = createClient(supabaseUrl, supabaseKey);

    // Funktion zur Anzeige der Kategorie
    function showCategory(category) {
        // Alle Kategorien ausblenden
        const categories = document.querySelectorAll('.category');
        categories.forEach(cat => cat.style.display = 'none');

        // Die ausgewählte Kategorie anzeigen
        document.getElementById(category).style.display = 'block';

        // Produkte für die gewählte Kategorie laden
        loadProductsByCategory(category);
    }

    // Produkte aus Supabase laden und nach Kategorie filtern
    async function loadProductsByCategory(category) {
        try {
            const { data: products, error } = await supabase
                .from('products')
                .select('*')
                .eq('category', category);  // Filter nach Kategorie

            if (error) {
                console.error('Fehler beim Abrufen der Produkte:', error.message);
                return;
            }

            // HTML-Container für die Kategorie leeren
            const productList = document.getElementById(category);
            productList.innerHTML = '';

            // Produkte in die HTML einfügen
            products.forEach(product => {
                const productHtml = `
                    <div class="product">
                        <img src="${product.image_url}" alt="${product.name}">
                        <h2>${product.name}</h2>
                        <p>${product.description}</p>
                        <p>${product.price} €</p>
                    </div>
                `;
                productList.innerHTML += productHtml;
            });

        } catch (err) {
            console.error('Fehler beim Laden der Produkte:', err.message);
        }
    }

    // Bei Laden der Seite eine Standardkategorie anzeigen
    document.addEventListener('DOMContentLoaded', function() {
        showCategory('trauerkarten');  // Standardkategorie
    });

</script>
</body>
</html>
